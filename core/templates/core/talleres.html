{% extends 'core/base.html' %}
{% load static %}

{% block css %}
<style>
  /* --- ESTILOS PERSONALIZADOS --- */

  .object-fit-cover {
    object-fit: cover;
    height: 100%;
  }

  .card-taller {
    background: #fff;
    border-radius: 1.2rem;
    overflow: hidden;
    box-shadow: 0 0.6rem 1.2rem rgba(0, 0, 0, 0.08);
    transition: transform 0.25s ease, box-shadow 0.25s ease;
  }

  .card-taller:hover {
    transform: translateY(-6px);
    box-shadow: 0 1rem 1.8rem rgba(0, 0, 0, 0.12);
  }

  /* --- Panel derecho (información) --- */
  .card-taller .info {
    padding: 2rem 2.5rem;
    background-color: #2c2c2c; /* gris grafito */
    color: #f2f2f2;
  }

  .card-taller h3 {
    color: #bda4f0;
    font-weight: 700;
    margin-bottom: 1.2rem;
  }

  .card-taller ul {
    padding-left: 0;
    list-style: none;
    margin-bottom: 1rem;
  }

  .card-taller li {
    margin-bottom: 0.3rem;
  }

  .card-taller strong {
    color: #ffffff;
  }

  /* --- Servicios --- */
  .badge-servicio {
    background-color: #efe6f7 !important;
    color: #4b226d !important;
    border-radius: 20px;
    font-size: 0.85rem;
    font-weight: 500;
    padding: 0.4rem 0.9rem;
  }

  /* --- Botón destacado --- */
  .btn-agendar {
    background: linear-gradient(90deg, #8b5cf6 0%, #c084fc 100%);
    border: none;
    color: #fff;
    font-weight: 600;
    letter-spacing: 0.4px;
    box-shadow: 0 4px 10px rgba(139, 92, 246, 0.4);
    transition: all 0.3s ease;
  }

  .btn-agendar:hover {
    background: linear-gradient(90deg, #9f7aea 0%, #d6bcfa 100%);
    transform: translateY(-2px);
    box-shadow: 0 6px 15px rgba(139, 92, 246, 0.5);
  }

  .btn-agendar i {
    margin-left: 6px;
  }

  /* --- Ajustes visuales --- */
  .text-muted.small {
    font-size: 0.95rem;
    color: #d1d1d1 !important;
  }
</style>
{% endblock css %}

{% block contenido %}
<!-- ENCABEZADO -->
<div class="py-5 text-center mb-5">
  <h1 class="fw-bold text-uppercase">Talleres</h1>
</div>

<!-- LISTADO DE TALLERES -->
<div class="bg-light py-5">
  <div class="container">
    {% for taller in talleres %}
    <div class="row align-items-center mb-5 card-taller">
      
      <!-- Imagen -->
      <div class="col-md-5 p-0">
        <img src="{{ taller.imagen.url }}" 
             alt="{{ taller.nombreTaller }}" 
             class="img-fluid w-100 h-100 object-fit-cover">
      </div>

      <!-- Información -->
      <div class="col-md-7 info">
        <h3>{{ taller.nombreTaller|upper }}</h3>
        
        <ul>
          <li><strong>Encargado:</strong> {{ taller.idUsuario.pnombre }} {{ taller.idUsuario.ap_paterno }}</li>
          <li><strong>Teléfono:</strong> {{ taller.telefono }}</li>
          <li><strong>Dirección:</strong> {{ taller.direccion }} {{ taller.idComuna.nombreComuna }}</li>
        </ul>

        {% if taller.descripcion %}
        <p class="text-muted small mb-3">
          {{ taller.descripcion }}
        </p>
        {% endif %}

        <!-- Servicios -->
        {% with servicios=taller.tallerservicio_set.all %}
        {% if servicios %}
        <div class="mb-4">
          <strong class="d-block mb-2">Servicios ofrecidos:</strong>
          <div>
            {% for ts in servicios %}
            <span class="badge badge-servicio me-2 mb-2">
              {{ ts.idServicio.nombreServicio }}
              {% if ts.precio %}
                <small class="text-secondary">(${% widthratio ts.precio 1 1 %})</small>
              {% endif %}
            </span>
            {% endfor %}
          </div>
        </div>
        {% endif %}
        {% endwith %}

        <a href="{% url 'agendar_hora' taller.idTaller %}" 
           class="btn btn-agendar rounded-pill px-4 py-2">
          Agendar ahora <i class="bi bi-calendar-check"></i>
        </a>
      </div>
    </div>
    {% endfor %}
  </div>
</div>
{% endblock %}

{% block js %}
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
{% endblock js %}
